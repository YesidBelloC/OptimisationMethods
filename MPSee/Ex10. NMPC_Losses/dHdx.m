function y = dHdx(x,TVP,TVP_f,u,tau,lmd,Con)
Xf1=TVP_f(1);
Xf2=TVP_f(2);
Xf3=TVP_f(3);
q1=TVP_f(4);
q2=TVP_f(5);
q3=TVP_f(6);
w1=TVP_f(7);
w11=TVP_f(8);
Op1=TVP_f(9);
dt=TVP_f(10);
Xk1=x(1);
Xk2=x(2);
Xk3=x(3);
Uk1=u(1);
Lmdk1=lmd(1);
Lmdk2=lmd(2);
Lmdk3=lmd(3);
y=zeros(3,1);
if nargin == 7
    con=Con(:,tau);
    if con(1)>0
        r1=1;
    else
        r1=0;
    end
else
    r1=0;
end
y(1)=- (q1*(Xf1 - Xk1))/2 - q1*(conj(Xf1)/2 - conj(Xk1)/2);
y(2)=Lmdk1 - (q2*(Xf2 - Xk2))/2 - q2*(conj(Xf2)/2 - conj(Xk2)/2) - (3274243927004963*Lmdk2*conj(Xk2))/2594073385365405696 + w11*((592178315002946533203125*Xk2)/107549291621216510571184128 - 95598993209346077005625/503928154605597531045888) - (50*Lmdk3*conj(Uk1))/(29*((13*(abs(Uk1) - 91501/1250)^2)/10000 + (2425562378252069*((62500*abs(Xk2))/13659 - 63061/400)^2)/18446744073709551616 - 421300310219581/4398046511104)) + (947485304004714453125*Lmdk3*conj(Uk1)*conj(Xk2)*sign(Xk2)*((62500*abs(Xk2))/13659 - 63061/400))/(456684890111322762510336*((13*(abs(Uk1) - 91501/1250)^2)/10000 + (2425562378252069*((62500*abs(Xk2))/13659 - 63061/400)^2)/18446744073709551616 - 421300310219581/4398046511104)^2);
y(3)=- (q3*(Xf3 - Xk3))/2 - q3*(conj(Xf3)/2 - conj(Xk3)/2);
